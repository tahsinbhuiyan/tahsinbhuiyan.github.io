<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Ultimate Mobile Car Game</title>
<style>
body { margin:0; overflow:hidden; background:#000; font-family:Arial; }
canvas { display:block; }

#ui {
position:fixed;
top:10px;
left:10px;
color:white;
z-index:10;
}

#mobile {
position:fixed;
bottom:20px;
width:100%;
text-align:center;
}

#mobile button {
font-size:22px;
padding:15px 25px;
margin:10px;
border-radius:12px;
border:none;
background:#222;
color:white;
}
#gameOver {
position:fixed;
top:50%;
left:50%;
transform:translate(-50%,-50%);
color:white;
font-size:24px;
display:none;
text-align:center;
}
</style>
</head>
<body>

<div id="ui">
Score: <span id="score">0</span><br>
High Score: <span id="high">0</span><br>
Health: <span id="health">100</span><br>
Nitro: <span id="nitroBar">100</span>
</div>

<div id="gameOver">
GAME OVER<br><br>
<button onclick="restart()">Restart</button>
</div>

<canvas id="game"></canvas>

<div id="mobile">
<button id="left">â—€</button>
<button id="nitroBtn">ðŸ”¥</button>
<button id="right">â–¶</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = innerWidth;
canvas.height = innerHeight;

let score=0;
let high=localStorage.getItem("highscore")||0;
let difficulty=1;
let gameRunning=true;
let particles=[];
let roadOffset=0;
let dayCycle=0;

document.getElementById("high").innerText=high;

class Player{
constructor(){
this.width=50;
this.height=100;
this.x=canvas.width/2-25;
this.y=canvas.height-150;
this.speed=0;
this.maxSpeed=8;
this.acc=0.3;
this.friction=0.05;
this.health=100;
this.nitro=100;
this.nitroActive=false;
}
update(){
if(this.speed<this.maxSpeed) this.speed+=this.acc;
if(this.speed>0) this.speed-=this.friction;
if(this.nitroActive && this.nitro>0){
this.speed=this.maxSpeed*1.8;
this.nitro-=0.5;
}else{
if(this.nitro<100) this.nitro+=0.2;
}
this.x=Math.max(0,Math.min(canvas.width-this.width,this.x));
document.getElementById("nitroBar").innerText=Math.floor(this.nitro);
}
draw(){
ctx.fillStyle="red";
ctx.fillRect(this.x,this.y,this.width,this.height);
}
}

class Enemy{
constructor(){
this.width=50;
this.height=100;
this.x=Math.random()*(canvas.width-50);
this.y=-100;
this.speed=3+Math.random()*difficulty;
}
update(){ this.y+=this.speed; }
draw(){
ctx.fillStyle="blue";
ctx.fillRect(this.x,this.y,this.width,this.height);
}
}

class Particle{
constructor(x,y){
this.x=x;
this.y=y;
this.life=20;
this.size=5+Math.random()*5;
}
update(){
this.life--;
this.y+=Math.random()*5;
}
draw(){
ctx.fillStyle="orange";
ctx.fillRect(this.x,this.y,this.size,this.size);
}
}

let player=new Player();
let enemies=[];

function spawnEnemy(){
if(gameRunning)
enemies.push(new Enemy());
}
setInterval(spawnEnemy,1000);

function collision(a,b){
return a.x<b.x+b.width &&
a.x+a.width>b.x &&
a.y<b.y+b.height &&
a.y+a.height>b.y;
}

function drawRoad(){
roadOffset+=player.speed;
ctx.fillStyle= dayCycle<500 ? "#444":"#222";
ctx.fillRect(0,0,canvas.width,canvas.height);

ctx.strokeStyle="white";
ctx.lineWidth=4;
for(let i=-20;i<canvas.height;i+=40){
ctx.beginPath();
ctx.moveTo(canvas.width/2,i+(roadOffset%40));
ctx.lineTo(canvas.width/2,i+20+(roadOffset%40));
ctx.stroke();
}
}

function update(){
if(!gameRunning) return;

ctx.clearRect(0,0,canvas.width,canvas.height);
drawRoad();

player.update();
player.draw();

enemies.forEach((e,i)=>{
e.update();
e.draw();

if(collision(player,e)){
player.health-=10;
for(let p=0;p<15;p++) particles.push(new Particle(e.x,e.y));
enemies.splice(i,1);
}

if(e.y>canvas.height){
enemies.splice(i,1);
score++;
difficulty+=0.05;
}
});

particles.forEach((p,i)=>{
p.update();
p.draw();
if(p.life<=0) particles.splice(i,1);
});

if(player.health<=0){
gameOver();
}

document.getElementById("score").innerText=score;
document.getElementById("health").innerText=player.health;

dayCycle++;
if(dayCycle>1000) dayCycle=0;

requestAnimationFrame(update);
}

function gameOver(){
gameRunning=false;
document.getElementById("gameOver").style.display="block";
if(score>high){
localStorage.setItem("highscore",score);
}
}

function restart(){
location.reload();
}

update();


// Controls
document.getElementById("left").ontouchstart=()=>player.x-=40;
document.getElementById("right").ontouchstart=()=>player.x+=40;
document.getElementById("nitroBtn").ontouchstart=()=>player.nitroActive=true;
document.getElementById("nitroBtn").ontouchend=()=>player.nitroActive=false;

window.addEventListener("keydown",e=>{
if(e.key==="ArrowLeft") player.x-=20;
if(e.key==="ArrowRight") player.x+=20;
if(e.key===" ") player.nitroActive=true;
});
window.addEventListener("keyup",()=>player.nitroActive=false);

</script>
</body>
</html>
